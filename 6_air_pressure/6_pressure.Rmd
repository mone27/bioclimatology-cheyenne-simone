---
title: "6th Protocol: Air Pressure"
author: "Cheyenne Rueda and Simone Massaro"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  bookdown::pdf_document2:
    toc: true
    number_sections: true
    includes:
      in_header: "../preamble.tex"
  html_notebook:
    number_sections: true
header-includes:
  - \fancyhead[L]{Longwave radiation}
editor_options: 
  markdown: 
    wrap: 72
---
\newpage
# Motivation

Air pressure is commonly known by experts as afactor that is constantly regulating the characteristics of natural systems. Changes in cloud densities, clouds movement and humid conditions of air. All these are examples of how air dynamics alter natural components of earth. But, what is the reason that explains the movement of air pressure? The molecules floating in the air have different directional movements or for instance, changes in its momentum. Following the same process as water particles when heated, air molecules move faster when air is hot.Air pressure is as well strongly related with the weather humidity conditions. Air is fluid. The molecules can easily move in all directions (Bonan, 2019).

Theory explains the different layers the atmosphere is composed by. Each of these layers presents air in different amounts. The air of the atmosphere exerts pressure through  and this is known as air pressure or atmospheric pressure, which makes force towards the center of the planet from all directions, to all the earth component. More concretely, the troposphere (closest layer to earth surface) has the higher amount of air. 

# Background


Reduce to pressure level equation:

$$p(0) = p(z) exp({\frac{g \Delta z} {R_d T}})$$
and the following is used for the correction of humidity virtual temperature

$$T_v = T (1 + 0.608q)$$

where $q$ is the specific humidity.

correction for temperature?

Temperature of boiling water depending on pressure:

$$T_{boil} = 100 + 2.804 10^{-2} (p-1013.25hPa) - 1.384 10^{-5} (p-1013.25hPa)^2$$
There is a mean decrease of temperature with height -0.65/100m:
$$T=T_{st}+0.00325*z$$
One peculiarity of air pressure is the wide range of units used around the globe to measure it. .
The SI defines the Pa ($N/m^2$) as the unit for pressure. However, this is a small value so hPa (100 Pa) is commonly used as a reference amount of this unit.
Another unit that commonly used in barometers is the torr or mmHg. Thus, this are the values to change between units: 760 mmHg = 760 torr = 1013.25 hPa.

Pressure is also possible to be calculated using the different of height between 2 points with the used of the fixed barometric height formula. PReviously, this formula needed to be changed due to the decrease of pressure to any point not situated at sea level. 
$$\Delta z = -(R_d/g*t)*log(p_z/p_0)$$

# Sensors and measuring principle

The there are several sensors to measure the air pressure each one using a different measurement principles.

 - Mercury barometer. This is the oldest barometer and works by having a column of mercury in a tube with vacuum on one side and air other the other.
On the mercury there is the gravitational force that make it going down, while the air pressure pushes the column up. This two forces reaches and equilibrium and therefore it is possible to read the pressure using the height of the mercury column.
This sensor is not commonly used nowadays, first of all because mercury is dangerous. Then it requires error corrections for both the temperature (mercury expands with higher temperatures) and gravity acceleration constant, which changes depending on altitude and latitude.
 - Aneroid barometer. They have an aneroid capsule with vacuum (or low pressure) inside, air pressure tends to reduce the collapse the capsule while a spring keeps in open. By measuring the width of the capsule is possible to estimate the air pressure. The width of the capsule can be measured both in analog instruments or digital one, using a capacitor.
Those are the most widely used pressure sensors as they are compact, reliable and require no error correction.
 - Boiling barometer. They work by measuring the boiling temperature of water and then use this information to estimate the air pressure. There is a heater to make water boil and then an accurate thermometer measure the temperature of the water vapour. This is not the most convenient instrument, but it is the barometer with the highest accuracy.




\newpage

# Analysis

```{r, include=F}
library(tidyverse)
theme_set(theme_bw())
```


```{r, message = F}
pres <- read_csv("../Data_lectures/6_Air_pressure/TA_RH_PA_Leinefelde.csv")
```



```{r}
#utility funcs from air humidity notebook

# temp is in degrees celcius
get_es <-  function(ta)  6.1078 * exp((17.08085 * ta) / (234.175 + ta))

rh2ea <- function(rh, e_s) rh/100 * e_s
get_spec_hum <- function(e_a, p) 0.622 * e_a / (p - 0.378 * e_a) # note Kg Kg-1

c2k <- function(c) c + 273.15
k2c <- function(k) k - 273.15

# get virtual temperature. Ta is the air temp and q the specific humidity
get_tv <- function(ta, q) ta * (1 + 0.608 * q)

Rd <- 287.05 # J Kg-1 K-1 gas constant of dry air
get_press_sea_level <- function(pz, tv, Dz, g = 9.81) {
  pz * exp((g * Dz)/(Rd * c2k(tv)))
}

```

## Air pressure sea level
*Calculate the air pressure at sea level for the Leinefelde site.*

```{r}
heigth_diff <- 451 + 44 # elevation + tower height

pres <- pres %>%
  mutate(
    es = get_es(TA_degC),
    ea = rh2ea(RH_Perc, TA_degC),
    q = get_spec_hum(ea, PA_hPa),
    tv = get_tv(TA_degC, q),
    p0 = get_press_sea_level(PA_hPa, tv, heigth_diff)
  )
```

```{r, "air-pressure-plot", fig.cap="Air pressure at Leinefelde and estimated air pressure at sea level. Pressure has been corrected for air humidity. Data from Leinefelde flux tower (451 m + 41m tower) July 2020 - May 2021"}
pres %>%
        gather("location", "pressure", PA_hPa, p0, factor_key = T) %>%
ggplot(aes(Date, pressure, color=location)) +
  geom_line() +
labs(y="Pressure (hPa)") +
scale_colour_discrete(name="Location", labels = c("Leinefelde", "Sea level"))
```

You can see in Figure \@ref(fig:air-pressure-plot)
\newpage

##  Air pressure Brocken and water boling temperature

*Calculate the air pressure at top of the Brocken mountain (1141 m) for a pressure of 991.3 hPa and an air temperature of 15°C at the North campus (185 m). Assume a mean air temperature decrease of 0.5 K/100 m. At which temperature would water boil at the North Campus and on the Brocken?*



```{r}
pa_nc <- 991.3  # Air pressure north campus
Rd <- 287.05 # J Kg-1 K-1 gas constant of dry airç
g <- 9.81# m/s^2
z1 <- 1141 #m Brocken mountain Heigth
z0 <- 185 #m North campus Heigth
Z <- z0-z1
pa_brocken<-   991.3 * exp((g * Z)/(Rd * c2k(15)))#hPa would be the pressure at the Brocken mountain
```
```{r}
t_boil_nc <- (100 + 2.804e-2 * (pa_nc-1013.25) - 1.384e-5 *(pa_nc-1013.25)^2 )%>% round(2)
t_boil_brocken <- (100 + 2.804e-2 * (pa_brocken-1013.25) - 1.384e-5 * (pa_brocken-1013.25)^2 )%>% round(2)
```
The water would boil at `r t_boil_nc` °C at the North Campus and `r t_boil_brocken` °C on the Brocken.

